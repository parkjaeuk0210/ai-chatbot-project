const e={},t=function(t,n,i){let s=Promise.resolve();if(n&&n.length>0){let t=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),r=(null==i?void 0:i.nonce)||(null==i?void 0:i.getAttribute("nonce"));s=t(n.map(t=>{if((t=function(e){return"/"+e}(t))in e)return;e[t]=!0;const n=t.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(t,'"]').concat(i)))return;const s=document.createElement("link");return s.rel=n?"stylesheet":"modulepreload",n||(s.as="script"),s.crossOrigin="",s.href=t,r&&s.setAttribute("nonce",r),document.head.appendChild(s),n?new Promise((e,n)=>{s.addEventListener("load",e),s.addEventListener("error",()=>n(new Error("Unable to preload CSS for ".concat(t))))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(e=>{for(const t of e||[])"rejected"===t.status&&r(t.reason);return t().catch(r)})};class n{constructor(){this.GA_MEASUREMENT_ID="",this.initialized=!1,this.queue=[],this.sessionId=this.generateSessionId(),this.userId=this.getUserId(),this.init()}init(){this.GA_MEASUREMENT_ID&&(this.loadGoogleAnalytics(),this.initializeCustomTracking())}loadGoogleAnalytics(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=".concat(this.GA_MEASUREMENT_ID),e.onload=()=>{window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",this.GA_MEASUREMENT_ID,{send_page_view:!0,user_id:this.userId,custom_map:{dimension1:"user_type",dimension2:"session_id",dimension3:"language"}}),this.initialized=!0,this.processQueue()},document.head.appendChild(e)}initializeCustomTracking(){document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.track("page_visibility",{action:"hidden",time_on_page:this.getTimeOnPage()})}),window.addEventListener("error",e=>{this.trackError("javascript_error",{message:e.message,source:e.filename,line:e.lineno,column:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.trackError("unhandled_promise_rejection",{reason:e.reason})})}track(e,t={}){if(!this.initialized)return void this.queue.push({eventName:e,parameters:t});const n={...t,session_id:this.sessionId,timestamp:(new Date).toISOString(),user_agent:navigator.userAgent,screen_resolution:"".concat(screen.width,"x").concat(screen.height),language:navigator.language||"unknown"};window.gtag&&window.gtag("event",e,n)}trackError(e,t){this.track("error",{error_type:e,...t})}trackPerformance(e,t){this.track("performance",{metric_name:e,metric_value:t,metric_unit:"milliseconds"})}trackUserAction(e,t,n=null,i=null){const s={action:e,category:t};n&&(s.label=n),null!==i&&(s.value=i),this.track("user_action",s)}trackChatMessage(e,t,n=!1){this.track("chat_message",{message_type:e,message_length:t,has_attachment:n,session_messages_count:this.getSessionMessageCount()})}trackFeatureUsage(e,t={}){this.track("feature_usage",{feature_name:e,...t})}trackConversion(e,t=null){const n={conversion_type:e};null!==t&&(n.value=t,n.currency="USD"),this.track("conversion",n)}setUserProperties(e){window.gtag&&window.gtag("set","user_properties",e)}processQueue(){for(;this.queue.length>0;){const{eventName:e,parameters:t}=this.queue.shift();this.track(e,t)}}generateSessionId(){return"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}getUserId(){let e=localStorage.getItem("analytics_user_id");return e||(e="user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),localStorage.setItem("analytics_user_id",e)),e}getTimeOnPage(){return Date.now()-(window.analyticsPageLoadTime||Date.now())}getSessionMessageCount(){return parseInt(sessionStorage.getItem("message_count")||"0")}async requestConsent(){return new Promise(e=>{const t=localStorage.getItem("analytics_consent");if("granted"===t)e(!0);else if("denied"===t)e(!1);else{const t=confirm("이 웹사이트는 사용자 경험을 개선하기 위해 분석 도구를 사용합니다. 동의하시겠습니까?");localStorage.setItem("analytics_consent",t?"granted":"denied"),e(t)}})}disableTracking(){window["ga-disable-"+this.GA_MEASUREMENT_ID]=!0,localStorage.setItem("analytics_consent","denied")}enableTracking(){window["ga-disable-"+this.GA_MEASUREMENT_ID]=!1,localStorage.setItem("analytics_consent","granted")}}const i=new n;window.analyticsPageLoadTime=Date.now();const s=Object.freeze(Object.defineProperty({__proto__:null,Analytics:n,analytics:i},Symbol.toStringTag,{value:"Module"}));class r{constructor(){this.DSN="",this.environment="production",this.initialized=!1,this.Sentry=null,this.init()}async init(){if(this.DSN)try{const e=await t(()=>import("./external.DD_7RxYk.js").then(e=>e.i),[]).catch(()=>null),n=await t(()=>import("./external.DD_7RxYk.js").then(e=>e.a),[]).catch(()=>null);if(!e||!n)return;const{BrowserTracing:i}=n;this.Sentry=e,this.Sentry.init({dsn:this.DSN,environment:this.environment,integrations:[new i({tracingOrigins:["localhost",/^\//],routingInstrumentation:this.Sentry.browserTracingIntegration({enableLongAnimationFrame:!0,enableInp:!0})}),new this.Sentry.Replay({sessionSampleRate:.1,errorSampleRate:1,maskAllText:!1,maskAllInputs:!0,blockAllMedia:!1})],tracesSampleRate:"production"===this.environment?.1:1,release:"1.0.0",autoSessionTracking:!0,beforeBreadcrumb:(e,t)=>"console"===e.category&&"log"===e.level?null:e,beforeSend(e,t){if(e.exception){const e=t.originalException;if("development"===this.environment&&e&&e.message&&e.message.includes("NetworkError"))return null}return e.user&&(delete e.user.email,delete e.user.ip_address),e}}),this.initialized=!0,this.setUserContext(),this.Sentry.setTags({app_version:"1.0.0",browser:this.getBrowserInfo(),platform:navigator.platform})}catch(e){}}captureException(e,t={}){this.initialized&&this.Sentry&&this.Sentry.withScope(n=>{Object.keys(t).forEach(e=>{n.setContext(e,t[e])}),this.Sentry.captureException(e)})}captureMessage(e,t="info",n={}){this.initialized&&this.Sentry&&this.Sentry.withScope(i=>{Object.keys(n).forEach(e=>{i.setContext(e,n[e])}),this.Sentry.captureMessage(e,t)})}capturePerformance(e,t){if(!this.initialized||!this.Sentry)return;const n=this.Sentry.startTransaction({name:e,op:"custom"});Object.keys(t).forEach(e=>{n.setMeasurement(e,t[e],"millisecond")}),n.finish()}addBreadcrumb(e){this.initialized&&this.Sentry&&this.Sentry.addBreadcrumb({timestamp:Date.now()/1e3,...e})}setUserContext(e={}){if(!this.initialized||!this.Sentry)return;const t=e.id||localStorage.getItem("sentry_user_id")||this.generateUserId();this.Sentry.setUser({id:t,...e}),e.id||localStorage.setItem("sentry_user_id",t)}setTag(e,t){this.initialized&&this.Sentry&&this.Sentry.setTag(e,t)}setContext(e,t){this.initialized&&this.Sentry&&this.Sentry.setContext(e,t)}startTransaction(e,t="navigation"){return this.initialized&&this.Sentry?this.Sentry.startTransaction({name:e,op:t}):null}trackAPIError(e,t,n={}){this.captureException(t,{api:{endpoint:e,method:n.method||"GET",status:t.status||"unknown",request_data:n}})}trackUserAction(e,t={}){this.addBreadcrumb({category:"user",message:e,level:"info",data:t})}trackStateChange(e,t,n){this.addBreadcrumb({category:"state",message:"".concat(e," changed"),level:"info",data:{old_value:t,new_value:n}})}generateUserId(){return"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}getBrowserInfo(){const e=navigator.userAgent;return e.includes("Chrome")?"Chrome":e.includes("Firefox")?"Firefox":e.includes("Safari")?"Safari":e.includes("Edge")?"Edge":"Other"}measurePageLoad(){if(!this.initialized||!this.Sentry||!window.performance)return;const e=performance.getEntriesByType("navigation")[0];e&&this.capturePerformance("page_load",{dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,dom_processing:e.domComplete-e.domLoading,total:e.loadEventEnd-e.fetchStart})}close(){this.initialized&&this.Sentry&&this.Sentry.close()}}const a=new r;"complete"===document.readyState?a.measurePageLoad():window.addEventListener("load",()=>{a.measurePageLoad()});const o=Object.freeze(Object.defineProperty({__proto__:null,SentryMonitor:r,sentryMonitor:a},Symbol.toStringTag,{value:"Module"}));export{t as _,s as a,o as s};
