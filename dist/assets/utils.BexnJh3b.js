import{_ as e}from"./monitoring.DUFPKEQd.js";const t=new class{constructor(){this.patterns={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,url:/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/,alphanumeric:/^[a-zA-Z0-9]+$/,safeText:/^[a-zA-Z0-9\s\-\_\.\,\!\?\@\#\$\%\&\*\(\)\[\]\{\}\:\;\'\"\u3131-\u314e\u314f-\u3163\uac00-\ud7a3\u4e00-\u9fff\u3040-\u309f\u30a0-\u30ff]+$/,noScript:/<script|<\/script|javascript:|on\w+\s*=/i,sqlInjection:/(\b(union|select|insert|update|delete|drop|create|alter|exec|execute)\b)|(--)|(;)|(\/\*)|(\*\/)/i},this.limits={message:5e3,url:2048,filename:255,persona:1e3}}validate(e,t){if("string"!=typeof e)return{valid:!1,error:"Input must be a string"};const s=this.limits[t];if(s&&e.length>s)return{valid:!1,error:"Input exceeds maximum length of ".concat(s," characters")};if(this.patterns.noScript.test(e))return{valid:!1,error:"Input contains potentially malicious script content"};if(this.patterns.sqlInjection.test(e))return{valid:!1,error:"Input contains potentially malicious SQL patterns"};switch(t){case"email":if(!this.patterns.email.test(e))return{valid:!1,error:"Invalid email format"};break;case"url":if(!this.patterns.url.test(e))return{valid:!1,error:"Invalid URL format"};break;case"message":case"persona":if(0===e.trim().length)return{valid:!1,error:"Input cannot be empty"};break;case"filename":if(e.includes("..")||e.includes("/")||e.includes("\\"))return{valid:!1,error:"Invalid filename"}}return{valid:!0}}sanitize(e,t){if("string"!=typeof e)return"";let s=e;switch(s=s.replace(/\0/g,""),t){case"html":s=s.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;");break;case"url":try{s=new URL(s).href}catch(r){s=encodeURI(s)}break;case"filename":s=s.replace(/[^a-zA-Z0-9\-\_\.]/g,"_");break;case"message":s=s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"")}const n=this.limits[t];return n&&s.length>n&&(s=s.substring(0,n)),s}validateFile(e,t={}){const{maxSize:s=10485760,allowedTypes:n=[],allowedExtensions:r=[]}=t;if(!e||"object"!=typeof e)return{valid:!1,error:"Invalid file object"};if(e.size>s)return{valid:!1,error:"File size exceeds maximum of ".concat(s/1024/1024,"MB")};if(n.length>0&&!n.includes(e.type))return{valid:!1,error:"File type ".concat(e.type," is not allowed")};if(r.length>0&&e.name){const t=e.name.split(".").pop().toLowerCase();if(!r.includes(t))return{valid:!1,error:"File extension .".concat(t," is not allowed")}}if(e.name&&e.name.split(".").length>2){const t=e.name.split("."),s=["exe","scr","bat","cmd","com"];for(let e=0;e<t.length-1;e++)if(s.includes(t[e].toLowerCase()))return{valid:!1,error:"Suspicious file name detected"}}return{valid:!0}}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}};function s(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function n(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}async function r(e,t=1920,s=1080,n=.85){return new Promise((r,i)=>{const a=new FileReader;a.onload=a=>{const o=new Image;o.onload=()=>{const i=document.createElement("canvas");let a=o.width,c=o.height;a>c?a>t&&(c*=t/a,a=t):c>s&&(a*=s/c,c=s),i.width=a,i.height=c;i.getContext("2d").drawImage(o,0,0,a,c),i.toBlob(t=>{r({blob:t,dataUrl:i.toDataURL(e.type,n),width:a,height:c})},e.type,n)},o.onerror=i,o.src=a.target.result},a.onerror=i,a.readAsDataURL(e)})}async function i(t){try{if(!window.pdfjsLib){const{lazyLoadPdfJs:t}=await e(async()=>{const{lazyLoadPdfJs:e}=await import("./lazyLoader.D3e43cl2.js");return{lazyLoadPdfJs:e}},[]);await t()}const s=await t.arrayBuffer(),n=await window.pdfjsLib.getDocument(s).promise;let r="";for(let e=1;e<=n.numPages;e++){const t=await n.getPage(e),s=await t.getTextContent();r+=s.items.map(e=>e.str).join(" ")+"\n\n"}return r}catch(s){throw new Error("PDF íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}}function a(e,t){let s;return function(...n){s||(e.apply(this,n),s=!0,setTimeout(()=>s=!1,t))}}function o(){return"session-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9))}function c(e,s="message"){if("string"!=typeof e)return!1;return t.validate(e,s).valid}const l=new class{constructor(){this.errorLog=[],this.maxLogSize=100}handle(e,t={}){const s=function(e){const t=window.i18n;let s=t?t.t("error.general"):"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",n="",r="unknown",i="";return navigator.onLine?e.message.includes("429")?(r="rateLimit",s="â±ï¸ ìš”ì²­ í•œë„ ì´ˆê³¼",n="ë„ˆë¬´ ë§Žì€ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",i="â° 1ë¶„ í›„ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"):e.message.includes("401")||e.message.includes("403")?(r="auth",s="ðŸ” ì¸ì¦ ì˜¤ë¥˜",n="API ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.",i="ðŸ’ ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•˜ê±°ë‚˜ íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”"):e.message.includes("500")||e.message.includes("502")||e.message.includes("503")?(r="server",s=t?t.t("error.serverConfig"):"ðŸ–¥ï¸ ì„œë²„ ì˜¤ë¥˜",n=t?t.t("error.serverConfig"):"ì„œë²„ì— ì¼ì‹œì ì¸ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",i="â° ëª‡ ë¶„ í›„ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"):e.message.includes("timeout")?(r="timeout",s="â³ ìš”ì²­ ì‹œê°„ ì´ˆê³¼",n="ì‘ë‹µ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",i="ðŸ”„ ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ ì§ˆë¬¸ì„ ë” ì§§ê²Œ í•´ë³´ì„¸ìš”"):"TypeError"===e.name&&e.message.includes("fetch")?(r="network",s=t?t.t("error.network"):"ðŸŒ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì‹¤íŒ¨",n=t?t.t("error.network"):"ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",i="ðŸ”Œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”"):e.message.includes("content blocked")||e.message.includes("safety")?(r="safety",s="ðŸš« ì½˜í…ì¸  ì•ˆì „ ì œí•œ",n="ìš”ì²­í•˜ì‹  ë‚´ìš©ì´ ì•ˆì „ ì •ì±…ì— ì˜í•´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.",i="ðŸ“ ë‹¤ë¥¸ ë‚´ìš©ìœ¼ë¡œ ì‹œë„í•´ì£¼ì„¸ìš”"):e.message.includes("file")||e.message.includes("size")?(r="file",s="ðŸ“ íŒŒì¼ ì˜¤ë¥˜",n=e.message,i="ðŸ“„ íŒŒì¼ í¬ê¸°ë‚˜ í˜•ì‹ì„ í™•ì¸í•˜ì„¸ìš”"):(r="general",n=e.message||(t?t.t("error.general"):"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),i="ðŸ”„ íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"):(r="network",s=t?t.t("error.network"):"ðŸŒ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜",n=t?t.t("error.network"):"ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",i=t?t.t("action.checkConnection"):"ðŸ”„ ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”"),{type:r,title:s,message:n,action:i,fullMessage:"".concat(s,"\n\n").concat(n,"\n\n").concat(i),isRetryable:["network","timeout","server","rateLimit"].includes(r)}}(e);return this.logError({...s,timestamp:(new Date).toISOString(),context:t,originalError:e}),s}logError(e){this.errorLog.push(e),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(-this.maxLogSize)),"localhost"===window.location.hostname||window.location.hostname}getRecentErrors(e=10){return this.errorLog.slice(-e)}clearErrors(){this.errorLog=[]}};const d=new class{constructor(){this.nonce=this.generateNonce(),this.trustedTypes=null,this.init()}generateNonce(){const e=new Uint8Array(16);return crypto.getRandomValues(e),btoa(String.fromCharCode(...e))}init(){if(window.trustedTypes&&window.trustedTypes.createPolicy)try{this.trustedTypes=window.trustedTypes.createPolicy("feraApp",{createHTML:e=>this.sanitizeHTML(e),createScript:e=>e,createScriptURL:e=>{new URL(e,window.location.href);if(["https://cdnjs.cloudflare.com","https://cdn.tailwindcss.com","https://fonts.googleapis.com"].some(t=>e.startsWith(t)))return e;throw new Error("Untrusted script URL: ".concat(e))}})}catch(e){}this.setCSPMetaTag()}setCSPMetaTag(){const e=this.generateCSPContent(),t=document.createElement("meta");t.httpEquiv="Content-Security-Policy",t.content=e,document.head.appendChild(t)}generateCSPContent(){return["default-src 'self'","script-src 'self' 'nonce-".concat(this.nonce,"' https://cdnjs.cloudflare.com https://cdn.tailwindcss.com"),"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com","font-src 'self' https://fonts.gstatic.com","img-src 'self' data: blob: https:","connect-src 'self' https://fera-ai.vercel.app https://api.anthropic.com wss:","worker-src 'self' blob:","frame-src 'none'","object-src 'none'","base-uri 'self'","form-action 'self'","upgrade-insecure-requests"].join("; ")}sanitizeHTML(e){if(window.DOMPurify)return window.DOMPurify.sanitize(e,{ALLOWED_TAGS:["p","br","strong","em","a","img","div","span","pre","code","ul","ol","li"],ALLOWED_ATTR:["href","src","alt","class","id","data-*"],ALLOW_DATA_ATTR:!0});const t=document.createElement("div");return t.textContent=e,t.innerHTML}createTrustedHTML(e){return this.trustedTypes?this.trustedTypes.createHTML(e):this.sanitizeHTML(e)}addInlineScript(e){const t=document.createElement("script");t.setAttribute("nonce",this.nonce),t.textContent=e,document.head.appendChild(t)}getNonce(){return this.nonce}};const u=new class{constructor(e={}){this.limits={chat:{max:50,window:6e4},image:{max:10,window:3e5},api:{max:100,window:6e4},...e},this.attempts=new Map,this.blocked=new Map,setInterval(()=>this.cleanup(),6e4)}check(e,t="global"){const s="".concat(e,":").concat(t),n=this.limits[e];if(!n)return{allowed:!0};if(this.blocked.has(s)){const e=this.blocked.get(s);if(Date.now()<e)return{allowed:!1,retryAfter:Math.ceil((e-Date.now())/1e3),reason:"rate_limit_exceeded"};this.blocked.delete(s)}const r=Date.now(),i=(this.attempts.get(s)||[]).filter(e=>r-e<n.window);if(i.length>=n.max){const e=n.window;return this.blocked.set(s,r+e),{allowed:!1,retryAfter:Math.ceil(e/1e3),reason:"rate_limit_exceeded",limit:n.max,window:n.window}}return i.push(r),this.attempts.set(s,i),{allowed:!0,remaining:n.max-i.length,resetAt:Math.min(...i)+n.window}}cleanup(){const e=Date.now();for(const[t,s]of this.attempts){const n=t.split(":")[0],r=this.limits[n];if(r){const n=s.filter(t=>e-t<r.window);0===n.length?this.attempts.delete(t):this.attempts.set(t,n)}}for(const[t,s]of this.blocked)e>=s&&this.blocked.delete(t)}reset(e,t="global"){const s="".concat(e,":").concat(t);this.attempts.delete(s),this.blocked.delete(s)}getStatus(e,t="global"){const s="".concat(e,":").concat(t),n=this.limits[e];if(!n)return null;const r=this.attempts.get(s)||[],i=Date.now(),a=r.filter(e=>i-e<n.window);return{used:a.length,limit:n.max,remaining:Math.max(0,n.max-a.length),resetAt:a.length>0?Math.min(...a)+n.window:null}}};function m(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function p(e,t){if(d&&d.createTrustedHTML)try{const s=d.createTrustedHTML(t);return e.innerHTML=s,e}catch(n){}const s=function(e){return e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+\s*=\s*"[^"]*"/gi,"").replace(/on\w+\s*=\s*'[^']*'/gi,"").replace(/javascript:/gi,"").replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,"").replace(/<embed\b[^>]*>/gi,"").replace(/<link\b[^>]*>/gi,"")}(t);return e.innerHTML=s,e}const h=new class{constructor(){this.dbName="fera-ai-offline",this.version=1,this.db=null,this.isOnline=navigator.onLine,this.init(),this.setupEventListeners()}async init(){try{this.db=await this.openDB(),this.isOnline&&this.processPendingMessages()}catch(e){}}openDB(){return new Promise((e,t)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>t(s.error),s.onsuccess=()=>e(s.result),s.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("messages")){const e=t.createObjectStore("messages",{keyPath:"id",autoIncrement:!0});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("status","status",{unique:!1})}if(!t.objectStoreNames.contains("responses")){t.createObjectStore("responses",{keyPath:"messageId"}).createIndex("timestamp","timestamp",{unique:!1})}}})}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.processPendingMessages(),this.notifyUser("ì˜¨ë¼ì¸ ìƒíƒœë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤","success")}),window.addEventListener("offline",()=>{this.isOnline=!1,this.notifyUser("ì˜¤í”„ë¼ì¸ ìƒíƒœìž…ë‹ˆë‹¤. ë©”ì‹œì§€ê°€ ëŒ€ê¸°ì—´ì— ì €ìž¥ë©ë‹ˆë‹¤","warning")})}async addMessage(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(["messages"],"readwrite").objectStore("messages"),s={...e,timestamp:Date.now(),status:"pending",retryCount:0};return new Promise((e,n)=>{const r=t.add(s);r.onsuccess=()=>{e(r.result)},r.onerror=()=>n(r.error)})}async getMessages(e="pending"){if(!this.db)return[];const t=this.db.transaction(["messages"],"readonly").objectStore("messages").index("status");return new Promise((s,n)=>{const r=t.getAll(e);r.onsuccess=()=>s(r.result||[]),r.onerror=()=>n(r.error)})}async updateMessageStatus(e,t,s=null){if(!this.db)return;const n=this.db.transaction(["messages","responses"],"readwrite"),r=n.objectStore("messages"),i=n.objectStore("responses"),a=r.get(e);return new Promise((n,o)=>{a.onsuccess=()=>{const c=a.result;if(!c)return void o(new Error("Message not found"));c.status=t,c.lastUpdated=Date.now(),"failed"===t&&(c.retryCount=(c.retryCount||0)+1);const l=r.put(c);l.onsuccess=()=>{s&&"sent"===t&&i.put({messageId:e,response:s,timestamp:Date.now()}),n()},l.onerror=()=>o(l.error)},a.onerror=()=>o(a.error)})}async processPendingMessages(){if(this.isOnline)try{const t=await this.getMessages("pending");for(const s of t)if(s.retryCount>=3)await this.updateMessageStatus(s.id,"failed");else try{const e=await this.sendMessage(s);if(!e.ok)throw new Error("HTTP ".concat(e.status));{const t=await e.json();await this.updateMessageStatus(s.id,"sent",t),this.notifyMessageSent(s)}}catch(e){await this.updateMessageStatus(s.id,"failed");const t=Math.min(1e3*Math.pow(2,s.retryCount),3e4);setTimeout(()=>{this.isOnline&&this.processPendingMessages()},t)}}catch(e){}}async sendMessage(e){const{chatHistory:t,model:s,persona:n,sessionId:r,url:i}=e.data;return fetch("/api/chat-secure",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatHistory:t,model:s,persona:n,sessionId:r,url:i})})}notifyUser(e,t="info"){const s=document.createElement("div");s.className="offline-notification ".concat(t),s.textContent=e,s.style.cssText="\n            position: fixed;\n            bottom: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            padding: 12px 24px;\n            background: ".concat("success"===t?"#10b981":"warning"===t?"#f59e0b":"#3b82f6",";\n            color: white;\n            border-radius: 8px;\n            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n            z-index: 9999;\n            animation: slideUp 0.3s ease-out;\n        "),document.body.appendChild(s),setTimeout(()=>{s.style.animation="slideDown 0.3s ease-out",setTimeout(()=>s.remove(),300)},3e3)}notifyMessageSent(e){window.feraApp&&window.feraApp.chatManager&&window.feraApp.chatManager.addMessage(window.feraApp.chatMessages,"model",[{text:"ðŸ“¤ ì˜¤í”„ë¼ì¸ ì¤‘ ì €ìž¥ëœ ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."}])}async clearOldMessages(e=7){if(!this.db)return;const t=Date.now()-24*e*60*60*1e3,s=this.db.transaction(["messages","responses"],"readwrite"),n=s.objectStore("messages"),r=s.objectStore("responses"),i=await new Promise((e,t)=>{const s=n.getAll();s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)});for(const a of i)a.timestamp<t&&"pending"!==a.status&&(n.delete(a.id),r.delete(a.id))}async getStorageInfo(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate();return{usage:e.usage,quota:e.quota,percentUsed:e.usage/e.quota*100}}return null}};if(!document.querySelector("#offline-queue-styles")){const e=document.createElement("style");e.id="offline-queue-styles",e.textContent="\n        @keyframes slideUp {\n            from {\n                transform: translate(-50%, 100%);\n                opacity: 0;\n            }\n            to {\n                transform: translate(-50%, 0);\n                opacity: 1;\n            }\n        }\n        \n        @keyframes slideDown {\n            from {\n                transform: translate(-50%, 0);\n                opacity: 1;\n            }\n            to {\n                transform: translate(-50%, 100%);\n                opacity: 0;\n            }\n        }\n    ",document.head.appendChild(e)}const g=new class{constructor(e={}){this.options={root:null,rootMargin:"50px",threshold:.01,...e},this.observer=null,this.loadedElements=new WeakSet,this.init()}init(){"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(this.handleIntersection.bind(this),this.options))}handleIntersection(e){e.forEach(e=>{e.isIntersecting&&!this.loadedElements.has(e.target)&&(this.loadElement(e.target),this.loadedElements.add(e.target),this.observer.unobserve(e.target))})}loadElement(e){"IMG"===e.tagName&&e.dataset.src&&this.loadImage(e),"IFRAME"===e.tagName&&e.dataset.src&&(e.src=e.dataset.src,e.removeAttribute("data-src")),e.dataset.component&&this.loadComponent(e)}loadImage(e){const t=new Image;t.onload=()=>{e.src=t.src,e.classList.add("lazy-loaded"),e.dataset.placeholder&&setTimeout(()=>{e.style.filter="none",e.classList.remove("lazy-loading")},50)},t.onerror=()=>{e.dataset.fallback&&(e.src=e.dataset.fallback),e.classList.add("lazy-error")},t.src=e.dataset.src,e.removeAttribute("data-src")}async loadComponent(t){const s=t.dataset.component;try{const n=await((e,t,s)=>{const n=e[t];return n?"function"==typeof n?n():Promise.resolve(n):new Promise((e,n)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})})(Object.assign({"../components/typingIndicator.js":()=>e(()=>import("./components.B5NkJSc2.js"),[])}),"../components/".concat(s,".js"),3),r=n.default||n[s];if(r){new r(t);t.classList.add("component-loaded")}}catch(n){t.classList.add("component-error")}}observe(e){this.observer&&e?this.observer.observe(e):this.observer||this.loadElement(e)}observeAll(e){document.querySelectorAll(e).forEach(e=>this.observe(e))}disconnect(){this.observer&&this.observer.disconnect()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{g.observeAll("[data-src], [data-component]")}):g.observeAll("[data-src], [data-component]");const f=new class{constructor(){this.metrics={fcp:null,lcp:null,fid:null,cls:null,ttfb:null},this.init()}init(){this.observePaintTiming(),this.observeLCP(),this.observeFID(),this.observeCLS(),this.measureTTFB(),this.monitorMemory()}observePaintTiming(){try{new PerformanceObserver(e=>{for(const t of e.getEntries())"first-contentful-paint"===t.name&&(this.metrics.fcp=t.startTime,this.reportMetric("FCP",t.startTime))}).observe({entryTypes:["paint"]})}catch(e){}}observeLCP(){try{let e;const t=new PerformanceObserver(t=>{const s=t.getEntries();e=s[s.length-1]});t.observe({entryTypes:["largest-contentful-paint"]}),document.addEventListener("visibilitychange",()=>{e&&"hidden"===document.visibilityState&&(this.metrics.lcp=e.startTime,this.reportMetric("LCP",e.startTime),t.disconnect())})}catch(e){}}observeFID(){try{const e=new PerformanceObserver(t=>{for(const s of t.getEntries())"first-input"===s.name&&(this.metrics.fid=s.processingStart-s.startTime,this.reportMetric("FID",this.metrics.fid),e.disconnect())});e.observe({entryTypes:["first-input"]})}catch(e){}}observeCLS(){try{let e=0,t=[],s=0,n=[];const r=new PerformanceObserver(r=>{for(const i of r.getEntries())if(!i.hadRecentInput){const r=n[0],a=n[n.length-1];s&&i.startTime-a.startTime<1e3&&i.startTime-r.startTime<5e3?(s+=i.value,n.push(i)):(s=i.value,n=[i]),s>e&&(e=s,t=n,this.metrics.cls=e)}});r.observe({entryTypes:["layout-shift"]}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&null!==this.metrics.cls&&(this.reportMetric("CLS",this.metrics.cls),r.disconnect())})}catch(e){}}measureTTFB(){try{const e=performance.getEntriesByType("navigation")[0];e&&(this.metrics.ttfb=e.responseStart-e.requestStart,this.reportMetric("TTFB",this.metrics.ttfb))}catch(e){}}monitorMemory(){performance.memory&&setInterval(()=>{Math.round(performance.memory.usedJSHeapSize/1048576),Math.round(performance.memory.totalJSHeapSize/1048576),Math.round(performance.memory.jsHeapSizeLimit/1048576)},3e4)}reportMetric(e,t){window.gtag&&window.gtag("event",e,{value:Math.round(t),metric_value:t,metric_delta:t,event_category:"Web Vitals"})}getMetrics(){return this.metrics}};function w(){const e=document.head;["https://fonts.googleapis.com","https://fonts.gstatic.com","https://cdnjs.cloudflare.com"].forEach(t=>{const s=document.createElement("link");s.rel="preconnect",s.href=t,s.crossOrigin="",e.appendChild(s)});["https://cdn.tailwindcss.com"].forEach(t=>{const s=document.createElement("link");s.rel="dns-prefetch",s.href=t,e.appendChild(s)})}export{s as a,i as b,r as c,w as d,l as e,n as f,o as g,m as h,g as l,h as o,f as p,u as r,p as s,a as t,c as v};
